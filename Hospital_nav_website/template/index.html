<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hospital Navigator</title>
<style>
body { font-family:'Segoe UI',sans-serif;background:#f0f4f8; display:flex;justify-content:center;align-items:flex-start;min-height:100vh;margin:0;padding:20px; }
.navigator-container { background:#fff; padding:30px 40px; border-radius:15px; box-shadow:0 8px 20px rgba(0,0,0,0.1); width:100%; max-width:600px; text-align:center;}
h2{margin-bottom:25px;color:#333;}
label{display:block;text-align:left;margin-bottom:15px;font-weight:500;color:#555;}
input[type="text"]{width:100%;padding:10px 12px;margin-top:5px;border:1px solid #ccc;border-radius:8px;font-size:16px;transition:border-color 0.3s;}
input[type="text"]:focus{border-color:#4a90e2;outline:none;}
button{background:#4a90e2;color:white;border:none;padding:12px 25px;font-size:16px;border-radius:8px;cursor:pointer;transition:background 0.3s,transform 0.2s;margin-top:10px;}
button:hover{background:#357ABD;transform:translateY(-2px);}
#pathImg{max-width:500px;min-width:300px;border-radius:12px;box-shadow:0 5px 15px rgba(0,0,0,0.1);}
.navigator-input-wrapper{position:relative;}
#suggestions{position:absolute;background:#fff;border:1px solid #ccc;border-radius:8px;top:40px;width:calc(100% - 24px);max-height:120px;overflow-y:auto;z-index:100;}
#suggestions div{padding:5px 10px;cursor:pointer;}
#suggestions div:hover{background:#f0f0f0;}
</style>
</head>
<body>
<div class="navigator-container">
    <h2>Hospital Navigation</h2>
    <div class="navigator-input-wrapper">
        <label>Start Room:
            <input type="text" id="start" placeholder="Enter start room">
            <button onclick="startVoice('start')">ðŸŽ¤</button>
        </label>
        <div id="startSuggestions"></div>
    </div>
    <div class="navigator-input-wrapper">
        <label>End Room:
            <input type="text" id="end" placeholder="Enter end room">
            <button onclick="startVoice('end')">ðŸŽ¤</button>
        </label>
        <div id="endSuggestions"></div>
    </div>
    <button onclick="getPath()">Find Path</button>
    <div><img id="pathImg" src="" alt="Path will appear here"></div>
</div>

<script>
let roomTypes = [];

async function fetchRooms() {
    const res = await fetch("http://127.0.0.1:5000/get_rooms");
    roomTypes = await res.json();
}
fetchRooms();

function setupAutocomplete(inputId,suggestionsId){
    const input=document.getElementById(inputId);
    const suggBox=document.getElementById(suggestionsId);
    input.addEventListener("input",()=>{
        const val=input.value.toLowerCase();
        suggBox.innerHTML="";
        if(!val) return;
        roomTypes.filter(r=>r.toLowerCase().startsWith(val)).slice(0,5).forEach(r=>{
            const div=document.createElement("div");
            div.textContent=r;
            div.onclick=()=>{input.value=r;suggBox.innerHTML="";};
            suggBox.appendChild(div);
        });
    });
    document.addEventListener("click",e=>{if(!input.contains(e.target)) suggBox.innerHTML="";});
}

setupAutocomplete("start","startSuggestions");
setupAutocomplete("end","endSuggestions");

// ---------- Voice Input ----------
function startVoice(inputId){
    const input=document.getElementById(inputId);
    if(!('webkitSpeechRecognition' in window)){
        alert("Speech recognition not supported");
        return;
    }
    const recognition = new webkitSpeechRecognition();
    recognition.lang = 'en-US';
    recognition.interimResults=false;
    recognition.maxAlternatives=1;
    recognition.start();
    recognition.onresult=function(event){
        const transcript=event.results[0][0].transcript;
        input.value=transcript;
        input.dispatchEvent(new Event('input'));
    };
}

// ---------- Get Path ----------
async function getPath(){
    const start=document.getElementById("start").value.trim();
    const end=document.getElementById("end").value.trim();
    if(!start||!end){alert("Enter both start and end rooms.");return;}
    try{
        const response=await fetch("http://127.0.0.1:5000/get_path",{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({start,end})
        });
        if(!response.ok){
            const err=await response.json();
            alert("Error: "+err.error);
            return;
        }
        const blob=await response.blob();
        document.getElementById("pathImg").src=URL.createObjectURL(blob);
    }catch(e){console.error(e);alert("Failed to fetch path.");}
}
</script>
</body>
</html>






